{"version":3,"names":["_react","require","_subscribeToChanges","_interopRequireDefault","obj","__esModule","default","useSubscribeToChanges","identifier","onChange","onChangeRef","useRef","useEffect","current","cancelSubscription","init","subscribeToChanges","_cancelSubscription","_default","exports"],"sources":["useSubscribeToChanges.ts"],"sourcesContent":["import { useEffect, useRef } from 'react'\n\nimport subscribeToChanges from '../utils/subscribeToChanges'\n\nimport type { HKSampleTypeIdentifier } from '..'\n\nfunction useSubscribeToChanges<TIdentifier extends HKSampleTypeIdentifier>(\n  identifier: TIdentifier,\n  onChange: () => void,\n): void {\n  const onChangeRef = useRef(onChange)\n\n  useEffect(() => {\n    onChangeRef.current = onChange\n  }, [onChange])\n\n  useEffect(() => {\n    let cancelSubscription: (() => Promise<boolean>) | undefined\n\n    const init = async () => {\n      cancelSubscription = await subscribeToChanges(identifier, onChangeRef.current)\n    }\n    void init()\n\n    return () => {\n      void cancelSubscription?.()\n    }\n  }, [identifier])\n}\n\nexport default useSubscribeToChanges\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,mBAAA,GAAAC,sBAAA,CAAAF,OAAA;AAA4D,SAAAE,uBAAAC,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAI5D,SAASG,qBAAqBA,CAC5BC,UAAuB,EACvBC,QAAoB,EACd;EACN,MAAMC,WAAW,GAAG,IAAAC,aAAM,EAACF,QAAQ,CAAC;EAEpC,IAAAG,gBAAS,EAAC,MAAM;IACdF,WAAW,CAACG,OAAO,GAAGJ,QAAQ;EAChC,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;EAEd,IAAAG,gBAAS,EAAC,MAAM;IACd,IAAIE,kBAAwD;IAE5D,MAAMC,IAAI,GAAG,MAAAA,CAAA,KAAY;MACvBD,kBAAkB,GAAG,MAAM,IAAAE,2BAAkB,EAACR,UAAU,EAAEE,WAAW,CAACG,OAAO,CAAC;IAChF,CAAC;IACD,KAAKE,IAAI,CAAC,CAAC;IAEX,OAAO,MAAM;MAAA,IAAAE,mBAAA;MACX,OAAAA,mBAAA,GAAKH,kBAAkB,cAAAG,mBAAA,uBAAlBA,mBAAA,CAAqB,CAAC;IAC7B,CAAC;EACH,CAAC,EAAE,CAACT,UAAU,CAAC,CAAC;AAClB;AAAC,IAAAU,QAAA,GAEcX,qBAAqB;AAAAY,OAAA,CAAAb,OAAA,GAAAY,QAAA"}