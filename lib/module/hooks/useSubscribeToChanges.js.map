{"version":3,"names":["useEffect","useRef","subscribeToChanges","useSubscribeToChanges","identifier","onChange","onChangeRef","current","cancelSubscription","init","_cancelSubscription"],"sources":["useSubscribeToChanges.ts"],"sourcesContent":["import { useEffect, useRef } from 'react'\n\nimport subscribeToChanges from '../utils/subscribeToChanges'\n\nimport type { HKSampleTypeIdentifier } from '..'\n\nfunction useSubscribeToChanges<TIdentifier extends HKSampleTypeIdentifier>(\n  identifier: TIdentifier,\n  onChange: () => void,\n): void {\n  const onChangeRef = useRef(onChange)\n\n  useEffect(() => {\n    onChangeRef.current = onChange\n  }, [onChange])\n\n  useEffect(() => {\n    let cancelSubscription: (() => Promise<boolean>) | undefined\n\n    const init = async () => {\n      cancelSubscription = await subscribeToChanges(identifier, onChangeRef.current)\n    }\n    void init()\n\n    return () => {\n      void cancelSubscription?.()\n    }\n  }, [identifier])\n}\n\nexport default useSubscribeToChanges\n"],"mappings":"AAAA,SAASA,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAEzC,OAAOC,kBAAkB,MAAM,6BAA6B;AAI5D,SAASC,qBAAqBA,CAC5BC,UAAuB,EACvBC,QAAoB,EACd;EACN,MAAMC,WAAW,GAAGL,MAAM,CAACI,QAAQ,CAAC;EAEpCL,SAAS,CAAC,MAAM;IACdM,WAAW,CAACC,OAAO,GAAGF,QAAQ;EAChC,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;EAEdL,SAAS,CAAC,MAAM;IACd,IAAIQ,kBAAwD;IAE5D,MAAMC,IAAI,GAAG,MAAAA,CAAA,KAAY;MACvBD,kBAAkB,GAAG,MAAMN,kBAAkB,CAACE,UAAU,EAAEE,WAAW,CAACC,OAAO,CAAC;IAChF,CAAC;IACD,KAAKE,IAAI,CAAC,CAAC;IAEX,OAAO,MAAM;MAAA,IAAAC,mBAAA;MACX,OAAAA,mBAAA,GAAKF,kBAAkB,cAAAE,mBAAA,uBAAlBA,mBAAA,CAAqB,CAAC;IAC7B,CAAC;EACH,CAAC,EAAE,CAACN,UAAU,CAAC,CAAC;AAClB;AAEA,eAAeD,qBAAqB"}